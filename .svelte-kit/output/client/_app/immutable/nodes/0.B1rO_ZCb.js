import"../chunks/DsnmJJEf.js";import{i as f}from"../chunks/VjwJ5DFS.js";import{o as h}from"../chunks/4tzv8gyV.js";import{C as l,F as u,p as d,c as m,f as p,a as y,d as _}from"../chunks/CBH2oh36.js";import{i as g,a as S}from"../chunks/KHq5D6Xm.js";import{s as n}from"../chunks/DxmBqDFk.js";function k(r,o,i,s,t){l&&u();var a=o.$$slots?.[i],e=!1;a===!0&&(a=o.children,e=!0),a===void 0||a(r,e?()=>s:s)}function b(r,o){d(o,!1),h(async()=>{try{const{data:{user:t},error:a}=await n.auth.getUser();(a||!t)&&await n.auth.signOut()}catch(t){console.error("Session validation error:",t),await n.auth.signOut()}}),n.auth.onAuthStateChange(async(t,a)=>{try{if(t==="SIGNED_IN"||t==="TOKEN_REFRESHED"){const e=a?.access_token,c=a?.refresh_token;e&&c&&await fetch("/auth/cookie",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:e,refresh_token:c})})}else t==="SIGNED_OUT"&&await fetch("/auth/logout",{method:"POST"})}catch(e){console.error("Failed to sync auth cookies:",e)}finally{g("supabase:auth");try{await S()}catch{}}}),f();var i=m(),s=p(i);k(s,o,"default",{}),y(r,i),_()}export{b as component};
